<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Current Deep Learning Ecosystem from a Rust Developer Perspective - TiberiusBlog</title>
  <meta name="description" content="How I got involved After experimenting with Yolo for an university project I got really curious and excited about the whole computer vision field, and since most of it now based on deep convolutional networks I started reading up on them.
This quickly lead me to two fields: Tensorflow and Pytorch, both built to be used through the Python API. I followed some tutorials from Pytorch&rsquo;s official website and took some classes from Fast."><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "TiberiusBlog",
    
    "url": "https:\/\/tiberiusferreira.github.io\/blog\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/tiberiusferreira.github.io\/blog\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/tiberiusferreira.github.io\/blog\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/tiberiusferreira.github.io\/blog\/posts\/current_deep_learning_ecosystem_from_a_rust_developer_perspective\/",
          "name": "Current deep learning ecosystem from a rust developer perspective"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : ""
  },
  "headline": "Current Deep Learning Ecosystem from a Rust Developer Perspective",
  "description" : "How I got involved After experimenting with Yolo for an university project I got really curious and excited about the whole computer vision field, and since most of it now based on deep convolutional networks I started reading up on them.\nThis quickly lead me to two fields: Tensorflow and Pytorch, both built to be used through the Python API. I followed some tutorials from Pytorch\x26rsquo;s official website and took some classes from Fast.",
  "inLanguage" : "en",
  "wordCount":  739 ,
  "datePublished" : "2020-02-10T15:21:03",
  "dateModified" : "2020-02-10T15:21:03",
  "image" : "https:\/\/tiberiusferreira.github.io\/blog\/",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "https:\/\/tiberiusferreira.github.io\/blog\/posts\/current_deep_learning_ecosystem_from_a_rust_developer_perspective\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/tiberiusferreira.github.io\/blog\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/tiberiusferreira.github.io\/blog\/",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Current Deep Learning Ecosystem from a Rust Developer Perspective" />
<meta property="og:description" content="How I got involved After experimenting with Yolo for an university project I got really curious and excited about the whole computer vision field, and since most of it now based on deep convolutional networks I started reading up on them.
This quickly lead me to two fields: Tensorflow and Pytorch, both built to be used through the Python API. I followed some tutorials from Pytorch&rsquo;s official website and took some classes from Fast.">
<meta property="og:url" content="https://tiberiusferreira.github.io/blog/posts/current_deep_learning_ecosystem_from_a_rust_developer_perspective/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="TiberiusBlog" />

  <meta name="twitter:title" content="Current Deep Learning Ecosystem from a Rust Developer Perspective" />
  <meta name="twitter:description" content="How I got involved After experimenting with Yolo for an university project I got really curious and excited about the whole computer vision field, and since most of it now based on deep convolutional â€¦">
  <meta name="twitter:card" content="summary" />
  <meta name="generator" content="Hugo 0.64.0" />
  <link rel="alternate" href="https://tiberiusferreira.github.io/blog/index.xml" type="application/rss+xml" title="TiberiusBlog"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://tiberiusferreira.github.io/blog/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://tiberiusferreira.github.io/blog/css/syntax.css" /><link rel="stylesheet" href="https://tiberiusferreira.github.io/blog/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">




  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://tiberiusferreira.github.io/blog/">TiberiusBlog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="https://tiberiusferreira.github.io/blog/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="About" href="https://tiberiusferreira.github.io/blog/page/about/">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="posts-heading">
              
                <h1>Current Deep Learning Ecosystem from a Rust Developer Perspective</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h2 id="how-i-got-involved">How I got involved</h2>
<p>After experimenting with <a href="https://pjreddie.com/darknet/yolo/">Yolo</a> for an
<a href="https://tiberiusferreira.github.io/blog/posts/machine_learning_rust_simd_i">university project</a> I got really
curious and excited about the whole computer vision field, and since most of it now
based on deep convolutional networks I started reading up on them.</p>
<p>This quickly lead me to two fields: Tensorflow and Pytorch, both built to be used
through the Python API. I followed some tutorials from Pytorch&rsquo;s official website and
took some classes from <a href="https://www.fast.ai">Fast.ai course</a>.</p>
<h2 id="the-good">The good</h2>
<p>The classes were great and it is unbelievable how much power is put in the hands of
Python programmers without them needing to know much about how it all works.</p>
<p>Using Tensors as &ldquo;regular&rdquo; variables and populating gradients with a simple <code>.backward()</code>
is fantastic.
Need to make the code run on the GPU? Just call a <code>.cuda()</code> or <code>.to(device=cuda)</code>
is it almost as magical as the recent achievements of deep learning themselves.</p>
<h2 id="the-bad">The bad</h2>
<p>The trade-off, of course, is having to write Python
(or Swift, if TensorFlow for Swift takes off) and losing the ability to control-click
a function to see what it does since eventually you hit the Python/C++ interface,
the famous <a href="https://www.quora.com/What-is-the-2-language-problem-in-data-science">Two language problem</a>
(or three if you count CUDA).</p>
<p>Crossing this barrier is a challenge since the C++ part is normally distributed as a binary, but
even if one downloaded the source code, it is hard for both me and my IDE to jump between languages. It requires
shifting the mental model from one language to the other.</p>
<p>I have also grown very accustomed to the my IDE and compiler working together providing both
great autocomplete and catching most of my mistakes before or during compilation.</p>
<p>I can see why most data science people are in Python and why it makes sense to build the
deep learning ecosystem around them, but it is frustrating coming from Rust.</p>
<h2 id="the-future">The future</h2>
<p>These problems are known and used as motivation for creating Swift for Tensorflow during
the last two classes of <a href="https://www.fast.ai">Fast.ai course</a>. There, Swift is pitched
as a language as fast as C  <em>(that sounds familiar&hellip;)</em> with automatic differentiation
baked in the language, and most importantly,
<a href="https://forums.swift.org/t/what-makes-swift-infinitely-hackable/28531">&ldquo;infinitely hackable&rdquo;</a>
which boils down to being able to leverage accelerators directly through Swift, using
<a href="https://mlir.llvm.org">MLIR&rsquo;s</a> infrastructure and some meta-programing
(think CUDA-like DSL in Swift, but not NVIDIA specific).</p>
<p>This got me curious, what would would a Rust Deep Learning Library look like?</p>
<h2 id="what-would-it-take-to-build-an-usable-dl-library-in-rust">What would it take to build an &ldquo;usable&rdquo; DL library in Rust?</h2>
<blockquote>
<p>Warning: This is my take on the subject, which could be wildly wrong and naive.</p>
</blockquote>
<p>I know that is not <em>impossible</em>, since <a href="https://github.com/pjreddie/darknet">Yolo</a> uses its own
custom library written in C + CUDA.</p>
<h3 id="a-good-tensor-library">A good Tensor library</h3>
<p>Well, a Tensor library which can run on the CPU and GPU is a must. On the CPU front there is
<a href="https://github.com/rust-ndarray/ndarray">NDarray</a> which <a href="https://github.com/rust-ndarray/ndarray/issues/89#issuecomment-284195600">doesn&rsquo;t plan</a> on supporting GPU
anytime soon.</p>
<p>Here I think the long term plan is going the same route as Swift, using MLIR (and ultimately the compiler)
to figure out the best way to execute a given computation on the hardware at hand. But while that
is not yet feasible using <a href="https://github.com/arrayfire/arrayfire-rust">Arrayfire</a> or <a href="https://github.com/bheisler/RustaCUDA">RustaCUDA</a>
should allow for an usable library.</p>
<p>For reference, Pytorch implements CUDA kernels directly, but I think it should be avoided as much
as possible since it is a lot of work, requires quite a lot of knowledge to do properly and leads to the <em>Two language problem</em>.</p>
<p>Since a great deal of DL computations are reduced to matrix multiplication and accumulation, we could
implement only these essential pieces using custom kernels hopefully getting 80% of the results for 20% of the work.</p>
<h3 id="automatic-differentiation">Automatic Differentiation</h3>
<p>Something like Pytorch&rsquo;s <a href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html">Autograd</a> system.</p>
<p>This might be a challenge given Rust ownership rules. There are some libraries in this area, such as
<a href="https://github.com/raskr/rust-autograd">Rust-Autograd</a> and <a href="https://github.com/maciejkula/wyrm">Wyrm</a>.</p>
<p>The former uses lazily evaluated graphs which helps with the ownership problems and the later
uses the Rc&laquo;RefCell&laquo;T&raquo;&raquo; pattern.</p>
<p>I&rsquo;ve been <a href="https://github.com/tiberiusferreira/Autograd-Experiments">exploring alternatives</a>, but I don&rsquo;t have anything
substantial to offer yet.</p>
<h3 id="what-if-i-want-something-now">What if I want something <em>now</em>?</h3>
<p>I&rsquo;ve used <a href="https://github.com/LaurentMazare/tch-rs">tch-rs</a> which a fantastic crate providing bindings from Pytorch (C++)
to Rust, which pretty much means all the power and most of the ergonomics of Pytorch, but from Rust!</p>
<p>However, it does not come without it&rsquo;s own problems, such as possible
<a href="https://github.com/LaurentMazare/tch-rs/issues/33">Undefined Behavior</a>
and a <a href="https://github.com/LaurentMazare/tch-rs/issues/152#issuecomment-583101903">Dangling Pointer</a>
every once in a while. The maintainer is very active, so those problems are not so bad in practice.</p>


        

        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://tiberiusferreira.github.io/blog/posts/machine_learning_rust_simd_ii/" data-toggle="tooltip" data-placement="top" title="Machine Learning, Rust and SIMD - II">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://tiberiusferreira.github.io/blog/posts/designing_autograd_system_rust_first_steps/" data-toggle="tooltip" data-placement="top" title="Designing an Autograd System with Rust - First Steps">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2020
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://tiberiusferreira.github.io/blog/">TiberiusBlog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.64.0</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://tiberiusferreira.github.io/blog/js/main.js"></script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://tiberiusferreira.github.io/blog/js/load-photoswipe.js"></script>









    
  </body>
</html>

